{
   "mappings":{
      "_default_":{
         "_meta":{
            "version":"6.8.11"
         },
         "date_detection":false,
         "dynamic_templates":[
            {
               "strings_as_keyword":{
                  "mapping":{
                     "type":"keyword"
                  },
                  "match_mapping_type":"string"
               }
            }
         ],
         "properties":{
            "@timestamp":{
               "type":"date"
            },
            "apache2":{
               "properties":{
                  "access":{
                     "properties":{
                        "agent":{
                           "norms":false,
                           "type":"text"
                        },
                        "body_sent":{
                           "properties":{
                              "bytes":{
                                 "type":"long"
                              }
                           }
                        },
                        "geoip":{
                           "properties":{
                              "city_name":{
                                 "type":"keyword"
                              },
                              "continent_name":{
                                 "type":"keyword"
                              },
                              "country_iso_code":{
                                 "type":"keyword"
                              },
                              "location":{
                                 "type":"geo_point"
                              },
                              "region_name":{
                                 "type":"keyword"
                              }
                           }
                        },
                        "http_version":{
                           "type":"keyword"
                        },
                        "method":{
                           "type":"keyword"
                        },
                        "referrer":{
                           "type":"keyword"
                        },
                        "remote_ip":{
                           "type":"keyword"
                        },
                        "response_code":{
                           "type":"long"
                        },
                        "url":{
                           "type":"keyword"
                        },
                        "user_agent":{
                           "properties":{
                              "device":{
                                 "type":"keyword"
                              },
                              "major":{
                                 "type":"long"
                              },
                              "minor":{
                                 "type":"long"
                              },
                              "name":{
                                 "type":"keyword"
                              },
                              "os":{
                                 "type":"keyword"
                              },
                              "os_major":{
                                 "type":"long"
                              },
                              "os_minor":{
                                 "type":"long"
                              },
                              "os_name":{
                                 "type":"keyword"
                              },
                              "patch":{
                                 "type":"keyword"
                              }
                           }
                        },
                        "user_name":{
                           "type":"keyword"
                        }
                     }
                  },
                  "error":{
                     "properties":{
                        "client":{
                           "type":"keyword"
                        },
                        "level":{
                           "type":"keyword"
                        },
                        "message":{
                           "type":"text"
                        },
                        "module":{
                           "type":"keyword"
                        }
                     }
                  }
               }
            },
            "auditd":{
               "properties":{
                  "log":{
                     "properties":{
                        "a0":{
                           "type":"keyword"
                        },
                        "acct":{
                           "type":"keyword"
                        },
                        "geoip":{
                           "properties":{
                              "city_name":{
                                 "type":"keyword"
                              },
                              "continent_name":{
                                 "type":"keyword"
                              },
                              "country_iso_code":{
                                 "type":"keyword"
                              },
                              "location":{
                                 "type":"geo_point"
                              },
                              "region_name":{
                                 "type":"keyword"
                              }
                           }
                        },
                        "item":{
                           "type":"keyword"
                        },
                        "items":{
                           "type":"keyword"
                        },
                        "new_auid":{
                           "type":"keyword"
                        },
                        "new_ses":{
                           "type":"keyword"
                        },
                        "old_auid":{
                           "type":"keyword"
                        },
                        "old_ses":{
                           "type":"keyword"
                        },
                        "pid":{
                           "type":"keyword"
                        },
                        "ppid":{
                           "type":"keyword"
                        },
                        "record_type":{
                           "type":"keyword"
                        },
                        "res":{
                           "type":"keyword"
                        },
                        "sequence":{
                           "type":"long"
                        }
                     }
                  }
               }
            },
            "beat":{
               "properties":{
                  "hostname":{
                     "type":"keyword"
                  },
                  "name":{
                     "type":"keyword"
                  },
                  "version":{
                     "type":"keyword"
                  }
               }
            },
            "error":{
               "type":"keyword"
            },
            "fileset":{
               "properties":{
                  "module":{
                     "type":"keyword"
                  },
                  "name":{
                     "type":"keyword"
                  }
               }
            },
            "input_type":{
               "type":"keyword"
            },
            "message":{
               "norms":false,
               "type":"text"
            },
            "meta":{
               "properties":{
                  "cloud":{
                     "properties":{
                        "availability_zone":{
                           "type":"keyword"
                        },
                        "instance_id":{
                           "type":"keyword"
                        },
                        "machine_type":{
                           "type":"keyword"
                        },
                        "project_id":{
                           "type":"keyword"
                        },
                        "provider":{
                           "type":"keyword"
                        },
                        "region":{
                           "type":"keyword"
                        }
                     }
                  }
               }
            },
            "mysql":{
               "properties":{
                  "error":{
                     "properties":{
                        "level":{
                           "type":"keyword"
                        },
                        "message":{
                           "norms":false,
                           "type":"text"
                        },
                        "thread_id":{
                           "type":"long"
                        },
                        "timestamp":{
                           "type":"keyword"
                        }
                     }
                  },
                  "slowlog":{
                     "properties":{
                        "host":{
                           "type":"keyword"
                        },
                        "id":{
                           "type":"long"
                        },
                        "ip":{
                           "type":"keyword"
                        },
                        "lock_time":{
                           "properties":{
                              "sec":{
                                 "type":"float"
                              }
                           }
                        },
                        "query":{
                           "type":"keyword"
                        },
                        "query_time":{
                           "properties":{
                              "sec":{
                                 "type":"float"
                              }
                           }
                        },
                        "rows_examined":{
                           "type":"long"
                        },
                        "rows_sent":{
                           "type":"long"
                        },
                        "timestamp":{
                           "type":"long"
                        },
                        "user":{
                           "type":"keyword"
                        }
                     }
                  }
               }
            },
            "nginx":{
               "properties":{
                  "access":{
                     "properties":{
                        "agent":{
                           "norms":false,
                           "type":"text"
                        },
                        "body_sent":{
                           "properties":{
                              "bytes":{
                                 "type":"long"
                              }
                           }
                        },
                        "geoip":{
                           "properties":{
                              "city_name":{
                                 "type":"keyword"
                              },
                              "continent_name":{
                                 "type":"keyword"
                              },
                              "country_iso_code":{
                                 "type":"keyword"
                              },
                              "location":{
                                 "type":"geo_point"
                              },
                              "region_name":{
                                 "type":"keyword"
                              }
                           }
                        },
                        "http_version":{
                           "type":"keyword"
                        },
                        "method":{
                           "type":"keyword"
                        },
                        "referrer":{
                           "type":"keyword"
                        },
                        "remote_ip":{
                           "type":"keyword"
                        },
                        "response_code":{
                           "type":"long"
                        },
                        "url":{
                           "type":"keyword"
                        },
                        "user_agent":{
                           "properties":{
                              "device":{
                                 "type":"keyword"
                              },
                              "major":{
                                 "type":"long"
                              },
                              "minor":{
                                 "type":"long"
                              },
                              "name":{
                                 "type":"keyword"
                              },
                              "os":{
                                 "type":"keyword"
                              },
                              "os_major":{
                                 "type":"long"
                              },
                              "os_minor":{
                                 "type":"long"
                              },
                              "os_name":{
                                 "type":"keyword"
                              },
                              "patch":{
                                 "type":"keyword"
                              }
                           }
                        },
                        "user_name":{
                           "type":"keyword"
                        }
                     }
                  },
                  "error":{
                     "properties":{
                        "connection_id":{
                           "type":"long"
                        },
                        "level":{
                           "type":"keyword"
                        },
                        "message":{
                           "norms":false,
                           "type":"text"
                        },
                        "pid":{
                           "type":"long"
                        },
                        "tid":{
                           "type":"long"
                        }
                     }
                  }
               }
            },
            "offset":{
               "type":"long"
            },
            "read_timestamp":{
               "type":"keyword"
            },
            "source":{
               "type":"keyword"
            },
            "system":{
               "properties":{
                  "auth":{
                     "properties":{
                        "groupadd":{
                           "properties":{
                              "gid":{
                                 "type":"long"
                              },
                              "name":{
                                 "type":"keyword"
                              }
                           }
                        },
                        "hostname":{
                           "type":"keyword"
                        },
                        "message":{
                           "type":"keyword"
                        },
                        "pid":{
                           "type":"long"
                        },
                        "program":{
                           "type":"keyword"
                        },
                        "ssh":{
                           "properties":{
                              "dropped_ip":{
                                 "type":"ip"
                              },
                              "event":{
                                 "type":"keyword"
                              },
                              "geoip":{
                                 "properties":{
                                    "city_name":{
                                       "type":"keyword"
                                    },
                                    "continent_name":{
                                       "type":"keyword"
                                    },
                                    "country_iso_code":{
                                       "type":"keyword"
                                    },
                                    "location":{
                                       "type":"geo_point"
                                    },
                                    "region_name":{
                                       "type":"keyword"
                                    }
                                 }
                              },
                              "ip":{
                                 "type":"ip"
                              },
                              "method":{
                                 "type":"keyword"
                              },
                              "port":{
                                 "type":"long"
                              },
                              "signature":{
                                 "type":"keyword"
                              }
                           }
                        },
                        "sudo":{
                           "properties":{
                              "command":{
                                 "type":"keyword"
                              },
                              "error":{
                                 "type":"keyword"
                              },
                              "pwd":{
                                 "type":"keyword"
                              },
                              "tty":{
                                 "type":"keyword"
                              },
                              "user":{
                                 "type":"keyword"
                              }
                           }
                        },
                        "timestamp":{
                           "type":"keyword"
                        },
                        "user":{
                           "type":"keyword"
                        },
                        "useradd":{
                           "properties":{
                              "gid":{
                                 "type":"long"
                              },
                              "home":{
                                 "type":"keyword"
                              },
                              "name":{
                                 "type":"keyword"
                              },
                              "shell":{
                                 "type":"keyword"
                              },
                              "uid":{
                                 "type":"long"
                              }
                           }
                        }
                     }
                  },
                  "syslog":{
                     "properties":{
                        "hostname":{
                           "type":"keyword"
                        },
                        "message":{
                           "type":"text"
                        },
                        "pid":{
                           "type":"keyword"
                        },
                        "program":{
                           "type":"keyword"
                        },
                        "timestamp":{
                           "type":"keyword"
                        }
                     }
                  }
               }
            },
            "tags":{
               "type":"keyword"
            },
            "type":{
               "type":"keyword"
            }
         }
      }
   },
   "order":0,
   "settings":{
      "index.mapping.total_fields.limit":10000,
      "index.refresh_interval":"5s"
   },
   "template":"filebeat-*"
}
